(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,n){},103:function(e,t){},106:function(e,t){},132:function(e,t){},133:function(e,t){},157:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),c=n(30),o=n.n(c),s=(n(97),n(1)),u=n.n(s),l=n(4),i=n(9),m=(n(101),n(12)),p=n(72),d=n(25),b=(n(85),n(33)),f=n(44),w=n(41),g=n(90),y=d.d.SystemProgram,h=(d.d.Keypair,Object.values(g._keypair.secretKey)),v=new Uint8Array(h),k=d.d.Keypair.fromSecretKey(v),E=new m.PublicKey(w.metadata.address),x=Object(m.clusterApiUrl)("devnet"),S="processed";function K(e){var t=e.split("/");return t[t.length-1].split("?")[0]}function j(e,t){for(var n=0;n<t.length;n++)if(t[n].tweetId===e)return!0;return!1}var O=function(){var e=Object(a.useState)(null),t=Object(i.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(""),s=Object(i.a)(o,2),g=s[0],h=s[1],v=Object(a.useState)(""),O=Object(i.a)(v,2),A=O[0],I=O[1],N=Object(a.useState)(""),T=Object(i.a)(N,2),P=T[0],C=T[1],M=Object(a.useState)(0),B=Object(i.a)(M,2),R=B[0],U=B[1],q=Object(a.useState)([]),F=Object(i.a)(q,2),L=F[0],W=F[1],D=function(){var e=Object(l.a)(u.a.mark(function e(){var t,n,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=window,!(n=t.solana)){e.next=12;break}if(!n.isPhantom){e.next=10;break}return console.log("Phantom wallet found!"),e.next=7,n.connect({onlyIfTrusted:!0});case 7:a=e.sent,console.log("Connected with Public Key:",a.publicKey.toString()),c(a.publicKey.toString());case 10:e.next=13;break;case 12:alert("Solana object not found! Get a Phantom Wallet \ud83d\udc7b");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0);case 18:case"end":return e.stop()}},e,null,[[0,15]])}));return function(){return e.apply(this,arguments)}}(),Y=function(){var e=Object(l.a)(u.a.mark(function e(){var t,n,a,r,o;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=window,!(n=t.solana)){e.next=11;break}return e.next=4,n.connect();case 4:return a=e.sent,r=Q(),o=new d.b(w,E,r),e.next=9,o.rpc.registerUser({accounts:{baseAccount:k.publicKey,user:r.wallet.publicKey}});case 9:console.log("Connected with Public Key:",a.publicKey.toString()),c(a.publicKey.toString());case 11:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(l.a)(u.a.mark(function e(){var t,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("trying to dc"),t=window,!(n=t.solana)){e.next=7;break}return e.next=5,n.disconnect();case 5:e.sent,c(null);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(l.a)(u.a.mark(function e(){var t,n,a;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==g.length){e.next=3;break}return console.log("not a tweet"),e.abrupt("return");case 3:return h(""),console.log("Link to tweet:",g),e.prev=5,t=Q(),n=new d.b(w,E,t),e.next=10,n.account.baseAccount.fetch(k.publicKey);case 10:if(e.sent,j(a=K(g),L)){e.next=24;break}if(0!==A.length&&0!==P){e.next=17;break}return console.log("need effort & reward for a new tweet"),e.abrupt("return");case 17:return h(""),I(""),C(""),e.next=22,n.rpc.submitTweet(a,new d.a(A),new d.a(P),{accounts:{baseAccount:k.publicKey,user:t.wallet.publicKey}});case 22:e.next=26;break;case 24:return e.next=26,n.rpc.resubmitTweet(a,{accounts:{baseAccount:k.publicKey,user:t.wallet.publicKey}});case 26:return e.next=28,Z();case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(5),console.log("Error sending tweet:",e.t0);case 33:case"end":return e.stop()}},e,null,[[5,30]])}));return function(){return e.apply(this,arguments)}}(),_=function(e){var t=e.target.value;h(t)},z=function(e){var t=e.target.value;C(t)},H=function(e){var t=e.target.value;I(t)},Q=function(){var e=new m.Connection(x,S);return new d.c(e,window.solana,S)},V=function(){var e=Object(l.a)(u.a.mark(function e(){var t,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Q(),n=new d.b(w,E,t),e.next=5,n.rpc.startProgram({accounts:{baseAccount:k.publicKey,user:t.wallet.publicKey,systemProgram:y.programId},signers:[k]});case 5:return console.log("Created a new BaseAccount w/ address:",k.publicKey.toString()),e.next=8,Z();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Error creating BaseAccount account:",e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])}));return function(){return e.apply(this,arguments)}}();function X(e){return e.locked?r.a.createElement("div",{className:"tweetbox-mined",key:e.id},r.a.createElement(p.a,{tweetId:e.id})):r.a.createElement("div",{className:"tweetbox-unmined",key:e.id},r.a.createElement(p.a,{tweetId:e.id}))}Object(a.useEffect)(function(){var e=function(){var e=Object(l.a)(u.a.mark(function e(){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return window.addEventListener("load",e),function(){return window.removeEventListener("load",e)}},[]);var Z=function(){var e=Object(l.a)(u.a.mark(function e(){var t,a,r,c,o,s,l;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Q(),a=new d.b(w,E,t),e.next=5,a.account.baseAccount.fetch(k.publicKey);case 5:for(r=e.sent,console.log("Got the account",r),c=[],console.log("i have ",r.tokenRegistry[0].tokens.words," tokens"),o=0;o<r.tweets.length;o++)c.push(r.tweets[o]),console.log("required effort",r.tweets[o].requiredEffort.words),console.log("current effort",r.tweets[o].currentEffort.words),console.log("this tweet is locked: ",r.tweets[o].locked);W(c),s=0,l=0;case 13:if(!(l<r.tokenRegistry.length)){e.next=20;break}if(r.tokenRegistry[l].userAddress.toString()!==n){e.next=17;break}return s=r.tokenRegistry[l].tokens.toNumber(),e.abrupt("break",20);case 17:l++,e.next=13;break;case 20:console.log(s),U(s),e.next=28;break;case 24:e.prev=24,e.t0=e.catch(0),console.log("Error in getTweets: ",e.t0),W(null);case 28:case"end":return e.stop()}},e,null,[[0,24]])}));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)(function(){n&&(console.log("Fetching tweets..."),Z())},[n]),r.a.createElement("div",{className:"App"},r.a.createElement(f.a,null,r.a.createElement(f.a.Item,{eventKey:"0"},r.a.createElement(f.a.Header,null,"Read rules before posting"),r.a.createElement(f.a.Body,null,r.a.createElement(b.a,null,r.a.createElement(b.a.Item,null,r.a.createElement("h1",{text:"white"},"Submission rules")),r.a.createElement(b.a.Item,null,r.a.createElement("p",null,"1. Each wallet is given two tweet tokens (not an actual token on Solana) upon registration.")),r.a.createElement(b.a.Item,null,r.a.createElement("p",null,"2. Submitting a new tweet to the wall requires spending a tweet token. Resubmitting an existing tweet does not")),r.a.createElement(b.a.Item,null,r.a.createElement("p",null,"3. When a new tweet submitted, the submitter must provide a) the amount of resubmissions it takes to mine the tweet (effort) and b) the amount of tweet tokens (reward) awarded to the miner of the tweet")),r.a.createElement(b.a.Item,null,r.a.createElement("p",null,"4. The miner of the tweet is defined as the wallet that provides the final resubmission needed to mine the tweet. The submitter cannot be the miner.")),r.a.createElement(b.a.Item,null,r.a.createElement("p",null,"5. The effort and reward of a tweet are known only to the initial poster of the tweet.")))))),r.a.createElement(function(){return null===n?r.a.createElement(r.a.Fragment,null):r.a.createElement("button",{className:"cta-button connect-wallet-button",onClick:G},"Disconnect")},null),r.a.createElement("div",{className:n?"authed-container":"container"},r.a.createElement("div",{className:"header-container"},r.a.createElement("p",{className:"header"},"Tweet Board"),r.a.createElement("p",{className:"sub-text"},"Mined tweets in green. Unmined tweets in yellow. Rules above."),r.a.createElement(function(){return null===n?r.a.createElement(r.a.Fragment,null):1===R?r.a.createElement("p",{className:"sub-text"},"You have 1 tweet token."):r.a.createElement("p",{className:"sub-text"},"You have ",R," tweet tokens.")},null),!n&&r.a.createElement("button",{className:"cta-button connect-wallet-button",onClick:Y},"Connect to Wallet"),n&&(null===L?r.a.createElement("div",{className:"connected-container"},r.a.createElement("button",{className:"cta-button submit-tweet-button",onClick:V},"Initialize the Program Account (Only needs to be done once)")):r.a.createElement("div",{className:"connected-container"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),J()}},r.a.createElement("input",{type:"text",placeholder:"Enter a link to a tweet",value:g,onChange:_}),r.a.createElement("input",{type:"text",placeholder:"Enter effort (# resubmissions)",value:A,onChange:H}),r.a.createElement("input",{type:"text",placeholder:"Enter reward (# tokens)",value:P,onChange:z}),r.a.createElement("button",{type:"submit",className:"cta-button submit-tweet-button"},"Submit")),r.a.createElement("div",{className:"tweet-grid"},L.map(function(e){return r.a.createElement(X,{id:e.tweetId,locked:e.locked})})))))))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(O,null)),document.getElementById("root"))},41:function(e){e.exports={version:"0.1.0",name:"backend",instructions:[{name:"startProgram",accounts:[{name:"baseAccount",isMut:!0,isSigner:!0},{name:"user",isMut:!0,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[],returns:null},{name:"registerUser",accounts:[{name:"baseAccount",isMut:!0,isSigner:!1},{name:"user",isMut:!0,isSigner:!0}],args:[],returns:null},{name:"submitTweet",accounts:[{name:"baseAccount",isMut:!0,isSigner:!1},{name:"user",isMut:!0,isSigner:!0}],args:[{name:"tweetId",type:"string"},{name:"requiredEffort",type:"u64"},{name:"reward",type:"u64"}],returns:null},{name:"resubmitTweet",accounts:[{name:"baseAccount",isMut:!0,isSigner:!1},{name:"user",isMut:!0,isSigner:!0}],args:[{name:"tweetId",type:"string"}],returns:null}],accounts:[{name:"BaseAccount",type:{kind:"struct",fields:[{name:"tweets",type:{vec:{defined:"TweetStruct"}}},{name:"tokenRegistry",type:{vec:{defined:"TokenBalance"}}}]}}],types:[{name:"TokenBalance",type:{kind:"struct",fields:[{name:"tokens",type:"u64"},{name:"userAddress",type:"publicKey"}]}},{name:"TweetStruct",type:{kind:"struct",fields:[{name:"tweetId",type:"string"},{name:"author",type:"publicKey"},{name:"miner",type:"publicKey"},{name:"requiredEffort",type:"u64"},{name:"currentEffort",type:"u64"},{name:"reward",type:"u64"},{name:"locked",type:"bool"}]}}],metadata:{address:"9ibCEh3Fb39Q9cDAjSamePo2bY3BdU6fXRfSWjVLyUqo"}}},90:function(e){e.exports={_keypair:{publicKey:{0:209,1:40,2:251,3:78,4:8,5:140,6:250,7:33,8:130,9:89,10:194,11:247,12:219,13:172,14:160,15:133,16:215,17:55,18:198,19:54,20:133,21:32,22:152,23:197,24:92,25:170,26:91,27:100,28:22,29:61,30:222,31:29},secretKey:{0:212,1:131,2:255,3:213,4:201,5:121,6:157,7:163,8:224,9:78,10:247,11:242,12:39,13:218,14:123,15:4,16:198,17:62,18:13,19:90,20:43,21:198,22:125,23:210,24:222,25:172,26:227,27:118,28:157,29:87,30:138,31:250,32:209,33:40,34:251,35:78,36:8,37:140,38:250,39:33,40:130,41:89,42:194,43:247,44:219,45:172,46:160,47:133,48:215,49:55,50:198,51:54,52:133,53:32,54:152,55:197,56:92,57:170,58:91,59:100,60:22,61:61,62:222,63:29}}}},92:function(e,t,n){e.exports=n(157)},97:function(e,t,n){}},[[92,2,1]]]);
//# sourceMappingURL=main.f22a1787.chunk.js.map